<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EzRugged - Token Creation</title>
    <script type="module">
        import { Connection, PublicKey, Transaction, SystemProgram, clusterApiUrl } from "https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/+esm";

        let walletPublicKey = null;
        
        async function connectWallet() {
            if (window.solana && window.solana.isPhantom) {
                try {
                    const response = await window.solana.connect();
                    walletPublicKey = response.publicKey.toString();
                    alert("Connected: " + walletPublicKey);
                } catch (err) {
                    console.error("Wallet Connection Error:", err);
                    alert("Failed to connect Phantom Wallet.");
                }
            } else {
                alert("Phantom Wallet not found! Install it from https://phantom.app/");
            }
        }

        async function triggerPayment() {
            if (!walletPublicKey) {
                alert("Please connect your Phantom Wallet first!");
                return;
            }

            try {
                const connection = new Connection(clusterApiUrl("devnet"), "confirmed");
                const transaction = new Transaction().add(
                    SystemProgram.transfer({
                        fromPubkey: new PublicKey(walletPublicKey),
                        toPubkey: new PublicKey("YOUR_WALLET_ADDRESS_HERE"),
                        lamports: 100000000,
                    })
                );

                transaction.feePayer = new PublicKey(walletPublicKey);
                transaction.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;

                const signedTransaction = await window.solana.signTransaction(transaction);
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());
                await connection.confirmTransaction(signature, "confirmed");

                alert("Payment successful! Transaction ID: " + signature);
            } catch (err) {
                console.error("Payment Error:", err);
                alert("Payment failed.");
            }
        }
    </script>
</head>
<body>
    <h1>EzRugged</h1>
    <button onclick="connectWallet()">Connect Phantom Wallet</button>
    <button onclick="triggerPayment()">Pay Fee</button>
</body>
</html>
